<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Biblioteca com Registro</title>
</head>
<body>
    <h1>üìö Biblioteca (Cadastro + Empr√©stimo)</h1>
    
    <div style="border: 2px solid blue; padding: 10px; margin-bottom: 10px;">
        <h3>1. Cadastrar Novo Item no Acervo</h3>
        <select id="tipoCadastro">
            <option value="livro">Livro</option>
            <option value="revista">Revista</option>
        </select>
        <input id="cadTitulo" placeholder="T√≠tulo">
        <input id="cadAutor" placeholder="Autor">
        <button onclick="botaoCadastrar()">Salvar no Sistema</button>
    </div>

    <div style="border: 2px solid green; padding: 10px;">
        <h3>2. Realizar Empr√©stimo</h3>
        <p>Digite o nome do livro que j√° foi cadastrado acima:</p>
        <input id="buscaTitulo" placeholder="T√≠tulo do livro para emprestar">
        <button onclick="botaoEmprestar()">Emprestar</button>
    </div>

    <h3>Itens Emprestados Agora:</h3>
    <ul id="listaTela"></ul>

    <script>
        // --- 1. MODELOS (As Classes dos Itens) ---
        
        // Classe Pai: Define o b√°sico que qualquer item tem
        class ItemAcervo {
            constructor(titulo, autor) {
                this.titulo = titulo;
                this.autor = autor;
            }
        }
        // Classe Filha: Livro (Herda de ItemAcervo e ganha o tipo "Livro")
        class Livro extends ItemAcervo {
            constructor(titulo, autor) { super(titulo, autor); this.tipo = "Livro"; }
        }
        // Classe Filha: Revista (Herda de ItemAcervo e ganha o tipo "Revista")
        class Revista extends ItemAcervo {
            constructor(titulo, autor) { super(titulo, autor); this.tipo = "Revista"; }
        }
    
        // --- 2. O SISTEMA (A Biblioteca) ---
        class Biblioteca {
            acervo = [];     // LISTA 1: A "Estante". Aqui ficam os livros que a biblioteca possui.
            emprestados = []; // LISTA 2: O "Caderno de Anota√ß√µes". Aqui fica quem pegou o qu√™.
    
            // FUNCIONALIDADE A: Cadastrar (Comprar o livro e por na estante)
            cadastrarItem(item) {
                // Valida√ß√£o: Procura no acervo se j√° tem um item com esse t√≠tulo
                let existe = this.acervo.find(i => i.titulo === item.titulo);
                
                // Se encontrou (existe √© verdadeiro), avisa e cancela (return)
                if(existe) { alert("J√° temos esse livro!"); return; }
    
                // Se n√£o existe, adiciona na lista do acervo
                this.acervo.push(item);
                alert("Item cadastrado com sucesso no sistema!");
            }
    
            // FUNCIONALIDADE B: Emprestar (Tirar da estante e dar para algu√©m)
            registrarEmprestimo(tituloBuscado) {
                // PASSO 1: Busca se o livro existe na ESTANTE (Acervo)
                let itemNoAcervo = this.acervo.find(i => i.titulo === tituloBuscado);
                
                // Se n√£o achou (√© undefined), avisa que n√£o tem como emprestar o que n√£o existe
                if (!itemNoAcervo) {
                    alert("Erro: Esse livro n√£o est√° cadastrado no sistema!");
                    return;
                }
    
                // PASSO 2: Cria o registro do empr√©stimo (O "Recibo")
                // Note que guardamos o objeto 'item' inteiro dentro do registro
                let registro = {
                    item: itemNoAcervo,  // O livro em si
                    dataSaida: new Date() // A hora que saiu
                };
    
                // Adiciona na lista de emprestados
                this.emprestados.push(registro);
                
                // Atualiza a tela para mostrar o novo empr√©stimo
                this.atualizarTela();
            }
    
            // Fun√ß√£o visual: Atualiza a lista <ul> no HTML
            atualizarTela() {
                let lista = document.getElementById("listaTela"); // Pega o elemento <ul>
                lista.innerHTML = ""; // Limpa ele
                
                // Para cada registro de empr√©stimo...
                this.emprestados.forEach(reg => {
                    // Adiciona uma linha (li) com o t√≠tulo e o tipo do livro
                    lista.innerHTML += `<li>Emprestado: ${reg.item.titulo} (${reg.item.tipo})</li>`;
                });
            }
        }
    
        // --- 3. INICIALIZA√á√ÉO ---
        const sistema = new Biblioteca(); // Cria a biblioteca vazia
    
        // Fun√ß√£o do Bot√£o "Salvar no Sistema"
        function botaoCadastrar() {
            // Pega os valores digitados nos inputs da √°rea azul
            let tipo = document.getElementById("tipoCadastro").value;
            let tit = document.getElementById("cadTitulo").value;
            let aut = document.getElementById("cadAutor").value;
    
            // Cria o objeto certo (Livro ou Revista) e manda cadastrar
            if(tipo === "livro") sistema.cadastrarItem(new Livro(tit, aut));
            else sistema.cadastrarItem(new Revista(tit, aut));
        }
    
        // Fun√ß√£o do Bot√£o "Emprestar"
        function botaoEmprestar() {
            // Pega o t√≠tulo que a pessoa digitou na busca (√°rea verde)
            let busca = document.getElementById("buscaTitulo").value;
            
            // Manda o sistema tentar emprestar esse t√≠tulo
            sistema.registrarEmprestimo(busca);
        }
    </script>
</body>
</html>